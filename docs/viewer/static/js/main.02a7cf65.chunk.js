(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){},19:function(e,t,n){},23:function(e,t){e.exports="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAwCAYAAAC4wJK5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGuSURBVGhD7ZjPqwFRGIbv/07SxEZSLCwUCws1KRYWaiwsLCwoiaKYsrCgKAt6b+fm3G7u5/IxZ+Y7t3nqKdnM+5QfZ+YD/4A4QgpxhBTiCCnEEVIQG7Fer6+vHiMuYjKZoFgsYj6fX995jJiIzWaDer2ORCLxpVURp9MJnU7ne7x1EYPBAJlM5leAFRGz2QzlcpkcrxUbsd1u0Wg0yNG3iou4XC7odrvk2HuKihgOh8jlcuTQvxQRsVwuUalUyIHPGGnEfr9Hs9kkh3GMLKLX6yGVSpGjuIYeMR6PUSgUyDGvGlqE7/uo1WrkiHc1HnE8HtFut8mLB6XRiH6/D8dxyAsHqZGI6XSKUqlEXtCEgUeo40IQP5scjX2c3v0D42j8i/3qUYKj8QjF+XxmH+o4hhKh4RyvOYYaoXnmRodjJBEadcuZzWbJYRwjjVDcu/nnGHmE5vYxDEcxERr9QIwae09xERp17kqn0+ToW8VGKA6HA1qtFjn8p6IjNKvVCtVqlQxQWhGhGY1GyOfzdkdoPM9DMpm0O0Kx2+3guq7dEZrFYmF/BJc4QgpxhAyAT37H75LDLfRTAAAAAElFTkSuQmCC"},24:function(e,t){e.exports="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAtCAYAAAA+7zKnAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGhSURBVGhD7Zixq4JAHMff/55IkINDg0NBg0OIi1AigYOBgkRLECEOEkENDUUOBQ2/h/G76T3eS7273wV+4Avq3f1+n0W88ws+mE6eik6eilryRVHglRrUkt/tdjAajSDLMnxCS235Xq/3iuu6cD6fcYSGxvIsYRjC8/nEGXJpLV/FNE1Yr9c4Sx5c5Fkmk4nUl5qrPIvneXC5XHCVOITIsyyXS1wpBqHyVYbDIWw2G6zAF+HyLLZtw+FwwEp8kCbP4vs+lGWJFdshXb5Kv9+HJEmwanNI5Fksy3rVbAqpPIvjOHA6nbDL+yghz7JYLODxeGC3/1FKvophGLBarbDj3ygnzzIejyHPc+z8O8rKV5nP53C9XrH7T5SUf/eDppR83a2EEvKapkEURdjlfcjl22yfyeR5HFyky/M8MkqV531YlyIv6jeJUHnRP6iEyA8GA0jTFFeJg7t8EARwv99xhVi4yU+nUzgejzhTDq3lq9PQdrvFGXJpLK/rOsRxjCM0NJKfzWZwu93wKR215ff7Pd7RU0teNTp5Kjp5Kj5YHuAbGi0/JXQ9+WUAAAAASUVORK5CYII="},25:function(e,t){e.exports="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOwAAAAtCAYAAACtZ4cFAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAIVSURBVHhe7dhZSwJxFIbxvv9niTaoiwqKQmmhpKIyUymVVivqQkWDk22mNXnO4DZn5nngvRmYu/+PWaaEiNwEWCJHAZbIUYAlchRgiRwFWCJHAZbIUYAlmnCNRkOeHh/kqlKRfO7s62pwgCUace8gH7tAHmb2ZTudkrXVZVmcn5WFmenO9nd3vu4KDrBEA9YP5NLCXA9IbYAlGrBhgtQGWCKlcYLUBlhKfFECqQ2wFPs8gdQGWHJfnEBqAyxFvh+Q5diD1AZYmnj/glxJHkhtgKWR12w25eXlWar3d1Ipl6RYOJeT4yPJ7O1IanNdUhvrgYeT/R1gaeB+gyzkcx2QW+nNT5T9BljzAEtq/Z6QJpDaAGseYGn0ILUB1jzAJqCJg9QGWPMAG4MiD1IbYM0DrIPcg9QGWPMAG4FiD1IbYM0D7BhKPEhtgDUPsEPotdWSWq32gfKhWpXzs9POYQSkYYA1D7CGfoO8vbmWSumy/aTMSy57KtmT4551g2WGAdY8wLYLC1IbYEMOsOYlAuywQWoDbMgB1rxYgB03SG2ADTnAmucCbCtiILUBNuQAa14kwHoDqQ2wIQdY88YC9h1kvV6PDUhtgA05wJo3FLCdb8jnZIDUBtiQA6x5ZrBBr6wXxSLrWhDYg8we67NvsMw2Fz+diMgWYIkcBVgiRwGWyFGAJXIUYIkcBVgiRwGWyFGAJXKTyBvf7jTa+8w6xgAAAABJRU5ErkJggg=="},40:function(e,t,n){},42:function(e,t,n){e.exports=n(91)},47:function(e,t,n){},48:function(e,t,n){},71:function(e,t){},90:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(8),o=n.n(i),s=(n(47),n(1)),c=n(2),u=n(5),l=n(3),h=n(4),p=(n(48),n(6)),d=n.n(p),f=n(7),v=n(14),m=function(){function e(){Object(s.a)(this,e),this._xmls=void 0,this._promises=void 0,this._xmls=new Map,this._promises=new Map}return Object(c.a)(e,[{key:"getXML",value:function(e){var t=this;if(this._xmls.has(e))return Promise.resolve(this._xmls.get(e));if(this._promises.has(e))return this._promises.get(e);var n=this.fetchXML(e);return this._promises.set(e,n),n.then(function(){t._promises.delete(e)}),n}},{key:"parseXML",value:function(e){return(new DOMParser).parseFromString(e,"text/xml")}},{key:"fetchXML",value:function(){var e=Object(f.a)(d.a.mark(function e(t){var n,r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return r=e.sent,a=this.parseXML(r),this._xmls.set(t,a),e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();m.documentCount=0;var b=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getRootElement",value:function(e){try{return e.getElementsByTagName("body")[0]}catch(t){throw console.error("Can't located body element of ".concat(this.code,": ").concat(t)),new Error("Can't locate body element")}}}]),t}(function(){function e(t,n,r){Object(s.a)(this,e),this.code="",this.name="",this.chunks=[],this.code=t,this.name=n,this.chunks=r}return Object(c.a)(e,[{key:"getChunkUrl",value:function(e){var t=e<10?"0".concat(e):"".concat(e);return"https://raw.githubusercontent.com/PghFrankenstein/fv-data/master/variorum-chunks/f".concat(this.code,"_C").concat(t,".xml")}},{key:"getXML",value:function(){var e=Object(f.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.cache.getXML(this.getChunkUrl(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}()),g=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),t}(b),w=function(){function e(t,n,r,a){Object(s.a)(this,e),this.edition=void 0,this.chunkNumber=void 0,this.tei=void 0,this.root=void 0,this.variations=void 0,this.edition=t,this.chunkNumber=n,this.tei=r,this.variations=a,this.root=t.getRootElement(r)}return Object(c.a)(e,[{key:"getApp",value:function(e){var t=this.variations.apps.find(function(t){return t.id===e});if(!t)throw new Error("Can't locate app ".concat(e));return t}},{key:"addAppReferences",value:function(){}}],[{key:"load",value:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,i,o;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getXML(r);case 2:return a=t.sent,t.next=5,N.getSpine(r);case 5:return i=t.sent,t.next=8,i.initialize();case 8:return(o=new e(n,r,a,i)).addAppReferences(),t.abrupt("return",o);case 11:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),k=n(41);function A(e,t){for(var n=e.createNSResolver(e.documentElement),r=e.evaluate(t,e,n),a=[],i=r.iterateNext();i;)a.push(i),i=r.iterateNext();return a}function x(e,t){var n=A(e,'//*[@xml:id="'.concat(t,'"]'));if(0===n.length)throw Error("Pointer ".concat(t," references an invalid element"));if(n.length>1)throw Error("Pointer ".concat(t," references more than one element"));return n[0]}function y(e,t){y=function(e,t){return new i(e,t)};var n=Object(k.a)(RegExp),r=RegExp.prototype,a=new WeakMap;function i(e,t){var r=n.call(this,e);return a.set(r,t),r}function o(e,t){var n=a.get(t);return Object.keys(n).reduce(function(t,r){return t[r]=e[n[r]],t},Object.create(null))}return Object(h.a)(i,n),i.prototype.exec=function(e){var t=r.exec.call(this,e);return t&&(t.groups=o(t,this)),t},i.prototype[Symbol.replace]=function(e,t){if("string"===typeof t){var n=a.get(this);return r[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"===typeof t){var i=this;return r[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==typeof e[e.length-1]&&e.push(o(e,i)),t.apply(this,e)})}return r[Symbol.replace].call(this,e,t)},y.apply(this,arguments)}var E=function(){function e(t,n){Object(s.a)(this,e),this.groupId=void 0,this.editions=void 0,this.apparatus=void 0,this.element=void 0,this.pointers=void 0,this.groupId=n,this.apparatus=t,this.editions=this.fillEditions(),this.pointers=this.fillPointers(),this.element=this.buildElement()}return Object(c.a)(e,[{key:"fillEditions",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=this.apparatus.pointers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;o.groupId===this.groupId&&-1===e.indexOf(o.edition)&&e.push(o.edition)}}catch(s){n=!0,r=s}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"fillPointers",value:function(){var e=this,t=this.editions[0];return this.apparatus.pointers.filter(function(n){return n.groupId===e.groupId&&n.edition===t})}},{key:"buildElement",value:function(){var e=document.implementation.createDocument(null,null,null),t=e.createElement("rdgGrp"),n=this.pointers.map(function(e){return e.dereferenced}),r=!0,a=!1,i=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value.cloneNode(!0);t.appendChild(c)}}catch(u){a=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return e.appendChild(t),t}}]),e}(),O=function(){function e(t){Object(s.a)(this,e),this.id=void 0,this.n=void 0,this.element=void 0,this.pointers=void 0,this._groups=void 0,this.element=t;var n=t.attributes.getNamedItem("xml:id");if(!n)throw new Error("<app> tag with no xml:id");this.id=n.value;var r=t.attributes.getNamedItem("n");this.n=r?parseInt(r.value):void 0,this.pointers=this.parsePointers(),this._groups=[]}return Object(c.a)(e,[{key:"buildGroups",value:function(){var e=this,t=new Set(this.pointers.map(function(e){return e.groupId}));this._groups=Array.from(t).map(function(t){return new E(e,t)})}},{key:"parsePointers",value:function(){var e=this;return Array.from(this.element.getElementsByTagName("ptr")).map(function(t){return e.parsePointer(t)})}},{key:"parsePointer",value:function(e){var t=e.parentNode;if(!t||"rdg"!==t.tagName)throw new Error("Parent of <ptr> is not <rdg>");var n=t.attributes.getNamedItem("wit");if(!n)throw new Error("<rdg> element does not have a wit attribute");var r,a=n.value.substr(2);try{r=N.getEdition(a)}catch(l){throw new Error("<rdg> has invalid witness ".concat(n.value))}var i=t.parentNode;if(!i||"rdgGrp"!==i.tagName)throw new Error("Parent of <rdg> element is not <rdgGrp>");var o=i.attributes.getNamedItem("xml:id");if(!o)throw new Error("<rdrGrp> has no xml:id");var s=o.value,c=e.attributes.getNamedItem("target");if(!c)throw new Error("<ptr> element has not target attribute");var u=c.value.split("#");if(2!==u.length)throw new Error("Target ".concat(c.value," is not well formatted. Expected uri#xpath"));return{ptrElement:e,edition:r,groupId:s,referencedUrl:u[0],referencedTarget:u[1]}}},{key:"getOtherGroups",value:function(e){return this.groups.filter(function(t){return-1===t.editions.indexOf(e)})}},{key:"groups",get:function(){return this._groups}}]),e}(),j=function(){function e(t){Object(s.a)(this,e),this.chunkNumber=void 0,this._apps=void 0,this._xml=void 0,this._initialized=!1,this._initializationPromise=void 0,this.chunkNumber=t}return Object(c.a)(e,[{key:"initialize",value:function(){var e=this;return this._initializationPromise?this._initializationPromise:(this._initializationPromise=this.innerInitialize(),this._initializationPromise.then(function(){e._initializationPromise=void 0}),this._initializationPromise)}},{key:"innerInitialize",value:function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getXML();case 4:return this._xml=e.sent,e.next=7,this.parseApps();case 7:return e.next=9,this.fetchAllReferences();case 9:return e.next=11,this.rewriteStringRanges();case 11:return e.next=13,this.dereferencePointers();case 13:this.addBackPointers(),this.buildGroupsInApps(),this._initialized=!0;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getXML",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chunkNumber<10?"0".concat(this.chunkNumber):"".concat(this.chunkNumber),n="https://raw.githubusercontent.com/PghFrankenstein/fv-data/master/standoff_Spine/spine_C".concat(t,".xml"),e.next=4,N.cache.getXML(n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseApps",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._xml){e.next=2;break}throw new Error("parseApps called before getXML, which makes no sense");case 2:t=Array.from(this._xml.getElementsByTagName("app")),n=t.map(function(e){return new O(e)}),this._apps=n;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchAllReferences",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,r,a,i,o,s,c,u,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=!0,r=!1,a=void 0,e.prev=4,i=this.apps[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)s=o.value,c=s.pointers.map(function(e){return e.referencedUrl}),t=t.concat(c);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),r=!0,a=e.t0;case 12:e.prev=12,e.prev=13,n||null==i.return||i.return();case 15:if(e.prev=15,!r){e.next=18;break}throw a;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return u=Array.from(new Set(t)),l=u.map(function(e){return N.cache.getXML(e)}),e.next=24,Promise.all(l);case 24:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return function(){return e.apply(this,arguments)}}()},{key:"rewriteStringRanges",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,r,a,i,o,s,c=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=y(/^string-range\((.+),(\d+),(\d+)\)$/,{xpath:1,start:2,length:3}),n=!0,r=!1,a=void 0,e.prev=4,i=d.a.mark(function e(){var n,r,a,i,o,u,l,h,p,f,v;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=s.value,r=new Set,a=!0,i=!1,o=void 0,e.prev=5,u=n.pointers[Symbol.iterator]();case 7:if(a=(l=u.next()).done){e.next=23;break}if(h=l.value,!(p=h.referencedTarget.match(t))){e.next=20;break}return f={xpath:p.groups.xpath,start:parseInt(p.groups.start),length:parseInt(p.groups.length)},e.prev=12,e.next=15,c.rewriteStringRange(h,f);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(12),r.add(h);case 20:a=!0,e.next=7;break;case 23:e.next=29;break;case 25:e.prev=25,e.t1=e.catch(5),i=!0,o=e.t1;case 29:e.prev=29,e.prev=30,a||null==u.return||u.return();case 32:if(e.prev=32,!i){e.next=35;break}throw o;case 35:return e.finish(32);case 36:return e.finish(29);case 37:v=n.pointers.filter(function(e){return!r.has(e)}),n.pointers=v;case 39:case"end":return e.stop()}},e,null,[[5,25,29,37],[12,17],[30,,32,36]])}),o=this.apps[Symbol.iterator]();case 7:if(n=(s=o.next()).done){e.next=12;break}return e.delegateYield(i(),"t0",9);case 9:n=!0,e.next=7;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(4),r=!0,a=e.t1;case 18:e.prev=18,e.prev=19,n||null==o.return||o.return();case 21:if(e.prev=21,!r){e.next=24;break}throw a;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[4,14,18,26],[19,,21,25]])}));return function(){return e.apply(this,arguments)}}()},{key:"rewriteStringRange",value:function(){var t=Object(f.a)(d.a.mark(function t(n,r){var a,i,o,s,c,u;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N.cache.getXML(n.referencedUrl);case 2:if(a=t.sent,i=r.xpath.replace(/tei:/g,""),0!==(o=A(a,i)).length){t.next=8;break}throw console.error("string-range for xpath ".concat(i," failed to return a node")),Error("string-range returned no nodes");case 8:if(!(o.length>1)){t.next=11;break}throw console.error("string-range for xpath ".concat(i," returned more than one node")),Error("string-range returned more than one node");case 11:s=o[0],c=s.attributes.getNamedItem("xml:id"),u="",c?u=c.value:(u="mock-id-".concat(e.mockElementCount),e.mockElementCount+=1,s.setAttribute("xml:id",u)),n.referencedTarget=u,n.ptrElement.setAttribute("target","".concat(n.referencedTarget,"#").concat(u));case 17:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"dereferencePointers",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,r,a,i,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,r=void 0,e.prev=3,a=d.a.mark(function e(){var t,n,r,a,i,s,c,u,l,h,p;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=o.value,n=new Set,r=!0,a=!1,i=void 0,e.prev=5,s=t.pointers[Symbol.iterator]();case 7:if(r=(c=s.next()).done){e.next=16;break}return u=c.value,e.next=11,N.cache.getXML(u.referencedUrl);case 11:l=e.sent;try{h=x(l,u.referencedTarget),u.dereferenced=h}catch(d){console.error("Pointer ".concat(u.ptrElement.outerHTML," is invalid")),n.add(u)}case 13:r=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),a=!0,i=e.t0;case 22:e.prev=22,e.prev=23,r||null==s.return||s.return();case 25:if(e.prev=25,!a){e.next=28;break}throw i;case 28:return e.finish(25);case 29:return e.finish(22);case 30:p=t.pointers.filter(function(e){return!n.has(e)}),t.pointers=p;case 32:case"end":return e.stop()}},e,null,[[5,18,22,30],[23,,25,29]])}),i=this.apps[Symbol.iterator]();case 6:if(t=(o=i.next()).done){e.next=11;break}return e.delegateYield(a(),"t0",8);case 8:t=!0,e.next=6;break;case 11:e.next=17;break;case 13:e.prev=13,e.t1=e.catch(3),n=!0,r=e.t1;case 17:e.prev=17,e.prev=18,t||null==i.return||i.return();case 20:if(e.prev=20,!n){e.next=23;break}throw r;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}},e,this,[[3,13,17,25],[18,,20,24]])}));return function(){return e.apply(this,arguments)}}()},{key:"addBackPointers",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.apps[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var i=r.value,o=!0,s=!1,c=void 0;try{for(var u,l=i.pointers[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var h=u.value;h.dereferenced?h.dereferenced.setAttribute("app-ref",i.id):console.error("Non dereferenced pointed in addBackPointers - pointers should all be dereferenced by now")}}catch(p){s=!0,c=p}finally{try{o||null==l.return||l.return()}finally{if(s)throw c}}}}catch(p){t=!0,n=p}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"buildGroupsInApps",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.apps[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.buildGroups()}}catch(i){t=!0,n=i}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"apps",get:function(){if(!this._apps)throw new Error("Spine not initialized yet");return this._apps}}]),e}();j.mockElementCount=0;var C=function(){function e(){Object(s.a)(this,e),this.cache=void 0,this.editions=void 0,this.spines=void 0,this.cache=new m,this.editions=[new b("1818","1818",[1,2,3,4,5,6,7,8,9,10]),new b("1823","1823",[1,2,3,4,5,6,7,8,9,10]),new b("1831","1831",[1,2,3,4,5,6,7,8,9,10]),new b("Thomas","Thomas",[1,2,3,4,5,6,7,8,9,10]),new g("MS","MS",[7,8,9,10])],this.spines=[1,2,3,4,5,6,7,8,9,10].map(function(e){return new j(e)})}return Object(c.a)(e,[{key:"getEdition",value:function(e){var t=this.editions.find(function(t){return t.code===e});if(!t)throw new Error("Can't find edition ".concat(e));return t}},{key:"getSpine",value:function(e){var t=this.spines.find(function(t){return t.chunkNumber===e});if(!t)throw new Error("Can't find spine for chunk ".concat(e));return t}}]),e}();C.instance=new C;var N=C.instance,S=(n(15),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="dot ed-".concat(this.props.edition.code);return a.a.createElement("span",{className:e})}}]),t}(a.a.Component)),T=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={availableEditions:[],edition:void 0},n.componentDidMount=function(){var e=N.editions.map(function(e,t){return{key:t,value:e.code,label:a.a.createElement("label",null,a.a.createElement(S,{edition:e}),e.name)}});n.setState({availableEditions:e})},n.editionChanged=function(e){var t=N.editions.find(function(t){return t.code===e.value});t?n.props.onEditionSelected(t):console.warn("Couldn't find edition for selection ".concat(e.value))},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("label",null,"CHOOSE A VERSION"),a.a.createElement(v.a,{className:"select-style",onChange:this.editionChanged,options:this.state.availableEditions}))}}]),t}(a.a.Component),I=n(22),V=n.n(I),R=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="",t="";return this.props.htmlTag&&(e="<".concat(this.props.htmlTag,">"),t="</".concat(this.props.htmlTag,">")),a.a.createElement("div",{className:"tei-element tei-".concat(this.props.tag),"data-tei-tag":this.props.tag},V()(e),this.props.children,V()(t))}}]),t}(a.a.Component),G=(n(19),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="tei-cdata";return this.props.showText||(e+=" no-text"),a.a.createElement("span",{className:e},this.props.text)}}]),t}(a.a.Component)),P=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).onClick=function(){n.props.showVariations&&n.props.onAppClick&&n.props.onAppClick(n.props.app)},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.showVariations)return a.a.createElement("div",{className:"app-wrapper-hidden"},this.props.children);var e=this.props.app.n||1,t="app-wrapper-content app-intensity-".concat(e<5?1:e<25?2:3),n=this.props.app.getOtherGroups(this.props.edition),r=[],i=!0,o=!1,s=void 0;try{for(var c,u=n[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var l=c.value.editions.map(function(e){return a.a.createElement(S,{edition:e})});(r=r.concat(l)).push(a.a.createElement("span",{className:"dot dot-break"}))}}catch(h){o=!0,s=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}return console.log("dotElements ",r),a.a.createElement("div",{className:"app-wrapper",onClick:this.onClick},a.a.createElement("div",{className:t},this.props.children),a.a.createElement("div",{className:"app-wrapper-dots"},r))}}]),t}(a.a.Component),U=function(){function e(t,n,r,a){Object(s.a)(this,e),this.showVariations=t,this.showText=n,this.edition=r,this.chunk=a}return Object(c.a)(e,[{key:"getHtmlTag",value:function(e){return"p"===e?"p":"head"===e?"h3":void 0}},{key:"buildProperties",value:function(e){for(var t=e.attributes,n={},r=0;r<t.length;r++){var a=t[r].nodeName;"xml:id"===a&&(a="id"),n[a]=t[r].nodeValue}return n}},{key:"teiToReactElement",value:function(t,n){var r=[];if(t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++){var o=t.childNodes[i],s=void 0;if(1===o.nodeType)s=this.teiToReactElement(o,n);else if(3===o.nodeType){var c=o.textContent||"";(c=c.trim())&&(s=a.a.createElement(G,{text:o.textContent||"",showText:this.showText,showVariations:this.showVariations,key:e.index++}))}else console.warn("Child node of unrecognizezd type: ",o);s&&r.push(s)}var u=this.buildProperties(t),l={tag:t.nodeName,key:e.index++,htmlTag:this.getHtmlTag(t.nodeName),showText:this.showText,showVariations:this.showVariations,teiProps:u},h=a.a.createElement(R,l,r);if(this.chunk&&this.showVariations&&u["app-ref"]){var p=this.chunk.getApp(u["app-ref"]);h=a.a.createElement(P,{key:e.index++,showVariations:this.showVariations,showText:this.showText,edition:this.edition,onAppClick:n,app:p},[h])}return h}}]),e}();U.index=0;var Y=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={element:void 0},n.getTeiObjects=function(){var e=n.props.chunk.root,t=new U(n.props.showVariations,n.props.showText,n.props.edition,n.props.chunk).teiToReactElement(e,n.props.onAppClick);n.setState({element:t})},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getTeiObjects()}},{key:"componentDidUpdate",value:function(e){e&&this.props.chunk===e.chunk&&this.props.edition===e.edition&&this.props.showText===e.showText&&this.props.showVariations===e.showVariations||this.getTeiObjects()}},{key:"render",value:function(){return a.a.createElement("div",{className:"tei-container"},this.state.element)}}]),t}(a.a.Component),_=n(23),D=n.n(_),M=n(24),B=n.n(M),Q=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={chunkIndex:n.props.chunk,selectedOption:void 0,availableChunks:[],disablePrev:!0,disableNext:!1},n.onChunkChanged=function(e){var t=parseInt(e.value),r=n.state.availableChunks.findIndex(function(e){return e.value===t.toString()});n.setState({chunkIndex:r,selectedOption:e}),n.props.onChunkSelected(t)},n.updateChunk=function(e){n.setState({disablePrev:!1,disableNext:!1});var t=n.state.chunkIndex+1+e;if(1===t?n.setState({disablePrev:!0}):t===n.state.availableChunks.length&&n.setState({disableNext:!0}),-1!==n.props.edition.chunks.indexOf(t)){var r=n.state.availableChunks.find(function(e){return e.value===t.toString()});r||console.error("Can't locate new option!"),n.setState({chunkIndex:t-1,selectedOption:r}),n.props.onChunkSelected(t)}},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.edition!==e.edition){var t=[];if(this.props.edition){t=this.props.edition.chunks.map(function(e){return{value:e.toString(),label:e.toString()}});var n=this.props.edition.chunks[0];this.setState({availableChunks:t,chunkIndex:0,selectedOption:t[0]}),this.props.onChunkSelected(n)}}}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,this.props.edition?a.a.createElement("div",null,a.a.createElement("div",{className:"in-line"},a.a.createElement("label",null,"CHOOSE A SECTION"),a.a.createElement(v.a,{className:"select-style",onChange:this.onChunkChanged,options:this.state.availableChunks,value:this.state.selectedOption})),a.a.createElement("div",{className:"in-line paging-buttons"},a.a.createElement("button",{onClick:function(){return e.updateChunk(-1)},className:this.state.disablePrev?"disable-button":"",disabled:this.state.disablePrev},a.a.createElement("img",{src:D.a,alt:D.a})),a.a.createElement("label",null,"Previous Section"),a.a.createElement("label",{className:"margin-button"},"Next Section"),a.a.createElement("button",{className:this.state.disableNext?"disable-button":"",onClick:function(){return e.updateChunk(1)},disabled:this.state.disableNext},a.a.createElement("img",{src:B.a,alt:B.a})))):"")}}]),t}(a.a.Component),X=(n(40),n(25)),L=n.n(X),H=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=N.editions.map(function(e,t){return a.a.createElement("label",{key:t,className:"edition-label"},a.a.createElement(S,{edition:e}),e.name)});return a.a.createElement("div",null,a.a.createElement("header",{className:"viewer__cols"},a.a.createElement("div",{id:"viewer__legend-editions"},e),a.a.createElement("div",{id:"viewer__title"},this.props.edition?a.a.createElement("h2",null,this.props.edition.name," Edition"):a.a.createElement("h2",null,"Edition")),a.a.createElement("div",{id:"viewer__legend-variance"},a.a.createElement("label",null,"Amount of Variance"),a.a.createElement("img",{src:L.a,alt:L.a}))),a.a.createElement("hr",{className:"line"}),a.a.createElement("div",{className:"viewer__cols"},a.a.createElement("div",null,"Marginalia"),a.a.createElement("div",null,"Text"),a.a.createElement("div",null,"Variations")))}}]),t}(a.a.Component),K=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={showVariations:!0,showText:!0},n.onVariationChanged=function(){var e=!n.state.showVariations;n.setState({showVariations:e}),n.props.onVariationChanged(e)},n.onTextChanged=function(){var e=!n.state.showText;n.setState({showText:e}),n.props.onTextChanged(e)},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.showVariations!==this.state.showVariations&&this.setState({showVariations:this.props.showVariations}),this.props.showText!==this.state.showText&&this.setState({showText:this.props.showText})}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("label",{className:"options-label"},"CHOOSE OPTIONS"),a.a.createElement("label",{className:"options-label"},a.a.createElement("input",{name:"variation",type:"checkbox",checked:this.state.showVariations,onChange:this.onVariationChanged}),"See Variants"),a.a.createElement("label",{className:"options-label"},a.a.createElement("input",{name:"text",type:"checkbox",checked:this.state.showText,onChange:this.onTextChanged}),"See Text"))}}]),t}(a.a.Component),J=(n(90),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.group.editions.map(function(e){return e.name}).join(", "),t=this.props.group.editions.map(function(e){return a.a.createElement(S,{edition:e})}),n=new U(!1,!0).teiToReactElement(this.props.group.element);return a.a.createElement("div",{className:"reading-group"},a.a.createElement("div",{className:"reading-group-dots"},t),a.a.createElement("div",{className:"reading-group-title"},e),a.a.createElement("div",{className:"reading-group-content"},n))}}]),t}(a.a.Component)),W=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.app.groups.map(function(e){return a.a.createElement(J,{group:e})});return a.a.createElement("div",{className:"app-list"},a.a.createElement("hr",{className:"app-list-to-divider"}),e)}}]),t}(a.a.Component),z=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={loading:!1,chunk:void 0,edition:void 0,chunkNumber:0,showVariations:!0,showText:!0,app:void 0},n.onNewChunk=function(){var e=Object(f.a)(d.a.mark(function e(t){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({loading:!0,chunk:void 0}),n.state.edition){e.next=3;break}throw new Error("Cannot get chunk if there is no an edition");case 3:return e.next=5,w.load(n.state.edition,t);case 5:r=e.sent,n.setState({loading:!1,chunk:r});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onNewEdition=function(e){n.setState({edition:e}),console.log("edition changed. state.edition=",n.state.edition)},n.onVariation=function(e){n.setState({showVariations:e})},n.onText=function(e){n.setState({showText:e})},n.onAppClick=function(e){n.setState({app:e})},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("section",{id:"viewer"},a.a.createElement("div",{id:"viewer__controls"},a.a.createElement(T,{key:0,editions:N.editions,edition:this.state.edition,onEditionSelected:this.onNewEdition}),a.a.createElement(Q,{key:1,edition:this.state.edition,chunk:this.state.chunkNumber,onChunkSelected:this.onNewChunk}),a.a.createElement(K,{showVariations:this.state.showVariations,showText:this.state.showText,onVariationChanged:this.onVariation,onTextChanged:this.onText})),a.a.createElement(H,{edition:this.state.edition}),a.a.createElement("div",{id:"viewer__contents",className:"viewer__cols"},a.a.createElement("aside",{id:"viewer__marginalia"}),this.state.chunk&&this.state.edition?a.a.createElement(Y,{chunk:this.state.chunk,edition:this.state.edition,showVariations:this.state.showVariations,showText:this.state.showText,onAppClick:this.onAppClick}):a.a.createElement("div",null),a.a.createElement("aside",{id:"viewer_variations"},this.state.app?a.a.createElement(W,{app:this.state.app,edition:this.state.edition}):"")),a.a.createElement("hr",{className:"line"}),a.a.createElement("footer",{id:"viewer_pagination_controls"},a.a.createElement("div",null),a.a.createElement(T,{key:2,editions:N.editions,edition:this.state.edition,onEditionSelected:this.onNewEdition}),a.a.createElement(Q,{key:3,edition:this.state.edition,chunk:this.state.chunkNumber,onChunkSelected:this.onNewChunk})))}}]),t}(a.a.Component),F=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("div",{className:"App"},a.a.createElement(z,null)))}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[42,1,2]]]);
//# sourceMappingURL=main.02a7cf65.chunk.js.map