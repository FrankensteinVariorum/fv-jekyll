(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,n){e.exports=n.p+"static/media/manicule.15158cdd.svg"},37:function(e,t,n){e.exports=n.p+"static/media/sgalogo.151f80c9.png"},38:function(e,t,n){e.exports=n.p+"static/media/intensity_legend.91d6f78c.svg"},40:function(e,t,n){e.exports=n(87)},45:function(e,t,n){},68:function(e,t){},86:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(8),o=n.n(r),s=(n(45),n(1)),c=n(2),u=n(6),l=n(4),h=n(5),p=n(3),d=n.n(p),f=n(7),m=n(14),v=function(){function e(){Object(s.a)(this,e),this._xmls=void 0,this._promises=void 0,this._xmls=new Map,this._promises=new Map}return Object(c.a)(e,[{key:"getXML",value:function(e){var t=this;if(this._xmls.has(e))return Promise.resolve(this._xmls.get(e));if(this._promises.has(e))return this._promises.get(e);var n=this.fetchXML(e);return this._promises.set(e,n),n.then(function(){t._promises.delete(e)}),n}},{key:"parseXML",value:function(e){return(new DOMParser).parseFromString(e,"text/xml")}},{key:"fetchXML",value:function(){var e=Object(f.a)(d.a.mark(function e(t){var n,a,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return a=e.sent,i=this.parseXML(a),this._xmls.set(t,i),e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();v.documentCount=0;var b=function(){function e(){Object(s.a)(this,e),this._jsons=void 0,this._promises=void 0,this._jsons=new Map,this._promises=new Map}return Object(c.a)(e,[{key:"getJSON",value:function(e){var t=this;if(this._jsons.has(e))return Promise.resolve(this._jsons.get(e));if(this._promises.has(e))return this._promises.get(e);var n=this.fetchJson(e);return this._promises.set(e,n),n.then(function(){t._promises.delete(e)}),n}},{key:"fetchJson",value:function(){var e=Object(f.a)(d.a.mark(function e(t){var n,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return n=e.sent,e.next=5,n.json();case 5:return(a=e.sent).constructor===Array&&(a={json:a}),this._jsons.set(t,a),e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();function g(e,t){var n=e.createNSResolver(e.documentElement);try{e.evaluate(t,e,n)}catch(o){console.error("xpath evaluation of ".concat(t," failed: "),o)}for(var a=e.evaluate(t,e,n),i=[],r=a.iterateNext();r;)i.push(r),r=a.iterateNext();return i}function k(e,t){var n=t.startsWith("mock")?"mock-id":"xml:id",a=g(e,"//*[@".concat(n,'="').concat(t,'"]'));if(0===a.length)throw Error("Pointer ".concat(t," references an invalid element"));if(a.length>1)throw Error("Pointer ".concat(t," references more than one element"));return a[0]}b.documentCount=0;var w=function(){function e(t,n,a){Object(s.a)(this,e),this.code="",this.name="",this.chunks=[],this.code=t,this.name=n,this.chunks=a}return Object(c.a)(e,[{key:"getChunkUrl",value:function(e){var t=e<10?"0".concat(e):"".concat(e);return"https://raw.githubusercontent.com/PghFrankenstein/fv-data/master/variorum-chunks/f".concat(this.code,"_C").concat(t,".xml")}},{key:"getXML",value:function(){var e=Object(f.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.cache.getXML(this.getChunkUrl(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getMarginRootElements",value:function(e){return[]}}]),e}(),y=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getMainRootElements",value:function(e){try{return[e.getElementsByTagName("body")[0]]}catch(t){throw console.error("Can't located body element of ".concat(this.code,": ").concat(t)),new Error("Can't locate body element")}}}]),t}(w),x=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getMainRootElements",value:function(e){return g(e,"//tei:zone[@type='main']").map(function(e){return e})}},{key:"getMarginRootElements",value:function(e){return g(e,"//tei:zone[@type='left_margin']").map(function(e){return e})}}]),t}(w),E=function(){function e(t,n,a,i,r){Object(s.a)(this,e),this.edition=void 0,this.chunkNumber=void 0,this.tei=void 0,this.mainRoots=void 0,this.marginRoots=void 0,this.variations=void 0,this.annotation=void 0,this.edition=t,this.chunkNumber=n,this.tei=a,this.variations=i,this.annotation=r,this.mainRoots=t.getMainRootElements(a),this.marginRoots=t.getMarginRootElements(a)}return Object(c.a)(e,[{key:"getApp",value:function(e){var t=this.variations.apps.find(function(t){return t.id===e});if(!t)throw new Error("Can't locate app ".concat(e));return t}}],[{key:"load",value:function(){var t=Object(f.a)(d.a.mark(function t(n,a){var i,r,o,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getXML(a);case 2:return i=t.sent,t.next=5,T.getSpine(a);case 5:return r=t.sent,t.next=8,r.initialize();case 8:if("MS"===n.code){t.next=14;break}return t.next=11,T.getAnnotation(n.code,a);case 11:return o=t.sent,t.next=14,o.initialize();case 14:return s=new e(n,a,i,r,o),t.abrupt("return",s);case 16:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),O=n(39);function j(e,t){j=function(e,t){return new r(e,t)};var n=Object(O.a)(RegExp),a=RegExp.prototype,i=new WeakMap;function r(e,t){var a=n.call(this,e);return i.set(a,t),a}function o(e,t){var n=i.get(t);return Object.keys(n).reduce(function(t,a){return t[a]=e[n[a]],t},Object.create(null))}return Object(h.a)(r,n),r.prototype.exec=function(e){var t=a.exec.call(this,e);return t&&(t.groups=o(t,this)),t},r.prototype[Symbol.replace]=function(e,t){if("string"===typeof t){var n=i.get(this);return a[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"===typeof t){var r=this;return a[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==typeof e[e.length-1]&&e.push(o(e,r)),t.apply(this,e)})}return a[Symbol.replace].call(this,e,t)},j.apply(this,arguments)}var C=function(){function e(t,n){Object(s.a)(this,e),this.grpElement=n,this.groupId=void 0,this.editions=void 0,this.apparatus=void 0,this.element=void 0,this.pointers=void 0,this.groupId=n.getAttribute("xml:id"),this.apparatus=t,this.editions=this.fillEditions(),this.pointers=this.fillPointers(),this.element=this.buildElement()}return Object(c.a)(e,[{key:"fillEditions",value:function(){return Array.from(this.grpElement.getElementsByTagName("rdg")).map(function(e){return e.getAttribute("wit").substr(2)}).map(function(e){return T.editions.find(function(t){return t.code===e})})}},{key:"fillPointers",value:function(){var e=this,t=this.editions[0];return this.apparatus.pointers.filter(function(n){return n.groupId===e.groupId&&n.edition===t})}},{key:"buildElement",value:function(){if(0!==this.pointers.length){var e=document.implementation.createDocument(null,null,null),t=e.createElement("rdgGrp"),n=this.pointers.map(function(e){return e.dereferenced}),a=!0,i=!1,r=void 0;try{for(var o,s=n[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var c=o.value.cloneNode(!0);t.appendChild(c)}}catch(u){i=!0,r=u}finally{try{a||null==s.return||s.return()}finally{if(i)throw r}}return e.appendChild(t),t}}}]),e}(),N=function(){function e(t){Object(s.a)(this,e),this.id=void 0,this.n=void 0,this.element=void 0,this.pointers=void 0,this._groups=void 0,this.element=t;var n=t.attributes.getNamedItem("xml:id");if(!n)throw new Error("<app> tag with no xml:id");this.id=n.value;var a=t.attributes.getNamedItem("n");this.n=a?parseInt(a.value):void 0,this.pointers=this.parsePointers(),this._groups=[]}return Object(c.a)(e,[{key:"buildGroups",value:function(){var e=this,t=Array.from(this.element.getElementsByTagName("rdgGrp"));this._groups=Array.from(t).map(function(t){return new C(e,t)})}},{key:"parsePointers",value:function(){var e=this;return Array.from(this.element.getElementsByTagName("ptr")).map(function(t){return e.parsePointer(t)})}},{key:"parsePointer",value:function(e){var t=e.parentNode;if(!t||"rdg"!==t.tagName)throw new Error("Parent of <ptr> is not <rdg>");var n=t.attributes.getNamedItem("wit");if(!n)throw new Error("<rdg> element does not have a wit attribute");var a,i=n.value.substr(2);try{a=T.getEdition(i)}catch(l){throw new Error("<rdg> has invalid witness ".concat(n.value))}var r=t.parentNode;if(!r||"rdgGrp"!==r.tagName)throw new Error("Parent of <rdg> element is not <rdgGrp>");var o=r.attributes.getNamedItem("xml:id");if(!o)throw new Error("<rdrGrp> has no xml:id");var s=o.value,c=e.attributes.getNamedItem("target");if(!c)throw new Error("<ptr> element has not target attribute");var u=c.value.split("#");if(2!==u.length)throw new Error("Target ".concat(c.value," is not well formatted. Expected uri#xpath"));return{ptrElement:e,edition:a,groupId:s,referencedUrl:u[0],referencedTarget:u[1]}}},{key:"getOtherGroups",value:function(e){return this.groups.filter(function(t){return-1===t.editions.indexOf(e)})}},{key:"groups",get:function(){return this._groups}}]),e}(),S=function(){function e(t){Object(s.a)(this,e),this.chunkNumber=void 0,this._apps=void 0,this._xml=void 0,this._initialized=!1,this._initializationPromise=void 0,this.chunkNumber=t}return Object(c.a)(e,[{key:"initialize",value:function(){var e=this;return this._initializationPromise?this._initializationPromise:(this._initializationPromise=this.innerInitialize(),this._initializationPromise.then(function(){e._initializationPromise=void 0}),this._initializationPromise)}},{key:"innerInitialize",value:function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getXML();case 4:return this._xml=e.sent,e.next=7,this.parseApps();case 7:return e.next=9,this.fetchAllReferences();case 9:return e.next=11,this.rewriteStringRanges();case 11:return e.next=13,this.dereferencePointers();case 13:this.addBackPointers(),this.buildGroupsInApps(),this._initialized=!0;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getXML",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chunkNumber<10?"0".concat(this.chunkNumber):"".concat(this.chunkNumber),n="https://raw.githubusercontent.com/PghFrankenstein/fv-data/master/standoff_Spine/spine_C".concat(t,".xml"),e.next=4,T.cache.getXML(n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseApps",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._xml){e.next=2;break}throw new Error("parseApps called before getXML, which makes no sense");case 2:t=Array.from(this._xml.getElementsByTagName("app")),n=t.map(function(e){return new N(e)}),this._apps=n;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchAllReferences",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a,i,r,o,s,c,u,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=!0,a=!1,i=void 0,e.prev=4,r=this.apps[Symbol.iterator]();!(n=(o=r.next()).done);n=!0)s=o.value,c=s.pointers.map(function(e){return e.referencedUrl}),t=t.concat(c);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),a=!0,i=e.t0;case 12:e.prev=12,e.prev=13,n||null==r.return||r.return();case 15:if(e.prev=15,!a){e.next=18;break}throw i;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return u=Array.from(new Set(t)),l=u.map(function(e){return T.cache.getXML(e)}),e.next=24,Promise.all(l);case 24:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return function(){return e.apply(this,arguments)}}()},{key:"rewriteStringRanges",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a,i,r,o,s,c=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=j(/^string-range\((.+),(\d+),(\d+)\)$/,{xpath:1,start:2,length:3}),n=!0,a=!1,i=void 0,e.prev=4,r=d.a.mark(function e(){var n,a,i,r,o,u,l,h,p,f,m;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=s.value,a=new Set,i=!0,r=!1,o=void 0,e.prev=5,u=n.pointers[Symbol.iterator]();case 7:if(i=(l=u.next()).done){e.next=23;break}if(h=l.value,!(p=h.referencedTarget.match(t))){e.next=20;break}return f={xpath:p.groups.xpath,start:parseInt(p.groups.start),length:parseInt(p.groups.length)},e.prev=12,e.next=15,c.rewriteStringRange(h,f);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(12),a.add(h);case 20:i=!0,e.next=7;break;case 23:e.next=29;break;case 25:e.prev=25,e.t1=e.catch(5),r=!0,o=e.t1;case 29:e.prev=29,e.prev=30,i||null==u.return||u.return();case 32:if(e.prev=32,!r){e.next=35;break}throw o;case 35:return e.finish(32);case 36:return e.finish(29);case 37:m=n.pointers.filter(function(e){return!a.has(e)}),n.pointers=m;case 39:case"end":return e.stop()}},e,null,[[5,25,29,37],[12,17],[30,,32,36]])}),o=this.apps[Symbol.iterator]();case 7:if(n=(s=o.next()).done){e.next=12;break}return e.delegateYield(r(),"t0",9);case 9:n=!0,e.next=7;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(4),a=!0,i=e.t1;case 18:e.prev=18,e.prev=19,n||null==o.return||o.return();case 21:if(e.prev=21,!a){e.next=24;break}throw i;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[4,14,18,26],[19,,21,25]])}));return function(){return e.apply(this,arguments)}}()},{key:"rewriteStringRange",value:function(){var t=Object(f.a)(d.a.mark(function t(n,a){var i,r,o,s,c,u;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.cache.getXML(n.referencedUrl);case 2:if(i=t.sent,0!==(r=g(i,a.xpath)).length){t.next=7;break}throw console.error("string-range for xpath ".concat(a.xpath," failed to return a node")),Error("string-range returned no nodes");case 7:if(!(r.length>1)){t.next=10;break}throw console.error("string-range for xpath ".concat(a.xpath," returned more than one node")),Error("string-range returned more than one node");case 10:o=r[0],s=o.attributes.getNamedItem("xml:id"),c=o.attributes.getNamedItem("mock-id"),u="",s?u=s.value:c?u=c.value:(u="mock-id-".concat(e.mockElementCount),e.mockElementCount+=1,o.setAttribute("mock-id",u)),n.referencedTarget=u,n.ptrElement.setAttribute("target","".concat(n.referencedUrl,"#").concat(u));case 17:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"dereferencePointers",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a,i,r,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,a=void 0,e.prev=3,i=d.a.mark(function e(){var t,n,a,i,r,s,c,u,l,h,p;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=o.value,n=new Set,a=!0,i=!1,r=void 0,e.prev=5,s=t.pointers[Symbol.iterator]();case 7:if(a=(c=s.next()).done){e.next=16;break}return u=c.value,e.next=11,T.cache.getXML(u.referencedUrl);case 11:l=e.sent;try{h=k(l,u.referencedTarget),u.dereferenced=h}catch(d){console.error("Pointer ".concat(u.ptrElement.outerHTML," is invalid")),n.add(u)}case 13:a=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),i=!0,r=e.t0;case 22:e.prev=22,e.prev=23,a||null==s.return||s.return();case 25:if(e.prev=25,!i){e.next=28;break}throw r;case 28:return e.finish(25);case 29:return e.finish(22);case 30:p=t.pointers.filter(function(e){return!n.has(e)}),t.pointers=p;case 32:case"end":return e.stop()}},e,null,[[5,18,22,30],[23,,25,29]])}),r=this.apps[Symbol.iterator]();case 6:if(t=(o=r.next()).done){e.next=11;break}return e.delegateYield(i(),"t0",8);case 8:t=!0,e.next=6;break;case 11:e.next=17;break;case 13:e.prev=13,e.t1=e.catch(3),n=!0,a=e.t1;case 17:e.prev=17,e.prev=18,t||null==r.return||r.return();case 20:if(e.prev=20,!n){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}},e,this,[[3,13,17,25],[18,,20,24]])}));return function(){return e.apply(this,arguments)}}()},{key:"addBackPointers",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,i=this.apps[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var r=a.value,o=new Set,s=!0,c=!1,u=void 0;try{for(var l,h=r.pointers[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var p=l.value;if(p.dereferenced){var d=!o.has(p.referencedUrl);p.dereferenced.setAttribute("app-ref",r.id),p.dereferenced.setAttribute("first-in-app",d?"true":"false"),o.add(p.referencedUrl)}else console.error("Non dereferenced pointed in addBackPointers - pointers should all be dereferenced by now")}}catch(f){c=!0,u=f}finally{try{s||null==h.return||h.return()}finally{if(c)throw u}}}}catch(f){t=!0,n=f}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"buildGroupsInApps",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,i=this.apps[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){a.value.buildGroups()}}catch(r){t=!0,n=r}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"apps",get:function(){if(!this._apps)throw new Error("Spine not initialized yet");return this._apps}}]),e}();S.mockElementCount=0;var _=function(){function e(t,n){Object(s.a)(this,e),this.editionCode=void 0,this.chunkNumber=void 0,this._json=void 0,this._initialized=!1,this._initializationPromise=void 0,this.editionCode=t,this.chunkNumber=n}return Object(c.a)(e,[{key:"initialize",value:function(){var e=this;return this._initializationPromise?this._initializationPromise:(this._initializationPromise=this.innerInitialize(),this._initializationPromise.then(function(){e._initializationPromise=void 0}),this._initializationPromise)}},{key:"innerInitialize",value:function(){var e=Object(f.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getJSON();case 4:return this._json=e.sent,e.next=7,this.parsePointers();case 7:this._initialized=!0;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getJSON",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://raw.githubusercontent.com/FrankensteinVariorum/fv-data/master/hypothesis/openannotation/".concat(this.editionCode,"_xml_id_mapping.json"),e.next=3,T.jcache.getJSON(t);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parsePointers",value:function(){var e=Object(f.a)(d.a.mark(function e(){var t,n,a=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.chunkNumber<10?"0".concat(this.chunkNumber):"".concat(this.chunkNumber),e.next=3,T.cache.getXML("https://raw.githubusercontent.com/PghFrankenstein/fv-data/master/variorum-chunks/f".concat(this.editionCode,"_C").concat(t,".xml"));case 3:n=e.sent,this._json.json.map(function(e){return a.parsePointer(e,n)});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parsePointer",value:function(e,t){var n=e.target.selector.filter(function(e){return"RangeSelector"===e.type})[0].startSelector.value,a=g(t,n);if(a.length>0){var i=a[0],r=i.getAttribute("annotatedBy");r?i.setAttribute("annotatedBy","".concat(r," ").concat(e.id)):i.setAttribute("annotatedBy",e.id)}return n}},{key:"getAnnotation",value:function(e){return this._json.json.filter(function(t){return t.id===e})[0]}}]),e}(),A=function(){function e(){Object(s.a)(this,e),this.cache=void 0,this.jcache=void 0,this.editions=void 0,this.spines=void 0,this.annotations=void 0,this.cache=new v,this.jcache=new b,this.editions=[new x("MS","MS",[7,8,9,10]),new y("1818","1818",[1,2,3,4,5,6,7,8,9,10]),new y("Thomas","Thomas",[1,2,3,4,5,6,7,8,9,10]),new y("1823","1823",[1,2,3,4,5,6,7,8,9,10]),new y("1831","1831",[1,2,3,4,5,6,7,8,9,10])],this.spines=[1,2,3,4,5,6,7,8,9,10].map(function(e){return new S(e)}),this.annotations=[1,2,3,4,5,6,7,8,9,10].map(function(e){return new _("1818",e)}).concat([1,2,3,4,5,6,7,8,9,10].map(function(e){return new _("1823",e)}),[1,2,3,4,5,6,7,8,9,10].map(function(e){return new _("1831",e)}),[1,2,3,4,5,6,7,8,9,10].map(function(e){return new _("Thomas",e)}))}return Object(c.a)(e,[{key:"getEdition",value:function(e){var t=this.editions.find(function(t){return t.code===e});if(!t)throw new Error("Can't find edition ".concat(e));return t}},{key:"getSpine",value:function(e){var t=this.spines.find(function(t){return t.chunkNumber===e});if(!t)throw new Error("Can't find spine for chunk ".concat(e));return t}},{key:"getAnnotation",value:function(e,t){var n=this.annotations.find(function(n){return n.editionCode===e&&n.chunkNumber===t});if(!n)throw new Error("Can't find annotations for edition ".concat(e));return n}}]),e}();A.instance=new A;var T=A.instance,P=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="dot ed-".concat(this.props.edition.code);return this.props.small&&(e+=" small-dot"),i.a.createElement("span",{className:e})}}]),t}(i.a.Component),I=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={availableEditions:[],selectedEdition:void 0},n.componentDidMount=function(){var e=T.editions.map(function(e,t){return{key:t,value:e.code,label:i.a.createElement("label",null,i.a.createElement(P,{edition:e}),e.name)}});n.setState({availableEditions:e,selectedEdition:e[0]}),n.props.onEditionSelected(n.props.editions[0])},n.editionChanged=function(e){var t=T.editions.find(function(t){return t.code===e.value});t?(n.setState({selectedEdition:e}),n.props.onEditionSelected(t)):console.warn("Couldn't find edition for selection ".concat(e.value))},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(e.edition!==this.props.edition){var n=this.state.availableEditions.find(function(e){return e.value===t.props.edition.code});n&&this.setState({selectedEdition:n})}}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("label",{className:"bold-choose"},"CHOOSE A VERSION"),i.a.createElement(m.a,{className:"select-style",onChange:this.editionChanged,options:this.state.availableEditions,value:this.state.selectedEdition}))}}]),t}(i.a.Component),V=n(21),M=n.n(V),z=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="",t="";return this.props.htmlTag&&(e="<".concat(this.props.htmlTag,">"),t="</".concat(this.props.htmlTag,">")),i.a.createElement("div",{className:"tei-element tei-".concat(this.props.tag),"data-tei-tag":this.props.tag},M()(e),this.props.children,M()(t))}}]),t}(i.a.Component),R=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="tei-cdata";return this.props.showText||(e+=" no-text"),i.a.createElement("span",{className:e},this.props.text)}}]),t}(i.a.Component),L=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).onClick=function(){n.props.showVariations&&n.props.onAppClick&&n.props.onAppClick(n.props.app)},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.showVariations)return i.a.createElement("div",{className:"app-wrapper-hidden"},this.props.children);var e=this.props.app.n||1,t="app-wrapper app-intensity-".concat(e<5?1:e<25?2:3),n=this.props.app.getOtherGroups(this.props.edition),a=[],r=0,o=!0,s=!1,c=void 0;try{for(var u,l=n[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var h=u.value.editions.map(function(e){return i.a.createElement(P,{small:!0,edition:e,key:e.code})});(a=a.concat(h)).push(i.a.createElement("span",{className:"dot dot-break",key:r})),r++}}catch(d){s=!0,c=d}finally{try{o||null==l.return||l.return()}finally{if(s)throw c}}var p="app-wrapper-dots";return this.props.showText||(p+=" no-text"),i.a.createElement("div",{className:t,onClick:this.onClick,"data-app":this.props.app.id},this.props.firstInApp?i.a.createElement("div",{className:p},a):"",this.props.children)}}]),t}(i.a.Component),B=n(36),X=n.n(B),U=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).onClick=function(e){n.props.showAnnotations&&n.props.onAnnotationClick&&(n.props.onAnnotationClick(n.props.annotations),e.stopPropagation())},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{onClick:this.onClick,style:{position:"absolute",width:"4em",cursor:"pointer",left:"-5em",marginTop:"1em",display:"flex",alignItems:"center",borderBottom:"1px solid grey"}},i.a.createElement("span",{style:{paddingRight:".5em",fontStyle:"italic"}},this.props.annotations.length),i.a.createElement("img",{src:X.a,style:{width:"40px"}})),this.props.children)}}]),t}(i.a.Component),G=function(){function e(t,n,a,i,r){Object(s.a)(this,e),this.showVariations=t,this.showAnnotations=n,this.showText=a,this.edition=i,this.chunk=r}return Object(c.a)(e,[{key:"getHtmlTag",value:function(e){return"p"===e?"p":"head"===e?"h3":"ab"===e?"p":void 0}},{key:"buildProperties",value:function(e){for(var t=e.attributes,n={},a=0;a<t.length;a++){var i=t[a].nodeName;"xml:id"===i&&(i="id"),n[i]=t[a].nodeValue}return n}},{key:"teiToReactElement",value:function(t,n,a){var r=this,o=[];if(t.hasChildNodes())for(var s=0;s<t.childNodes.length;s++){var c=t.childNodes[s],u=void 0;if(1===c.nodeType)u=this.teiToReactElement(c,n,a);else if(3===c.nodeType){var l=c.textContent||"";(l=l.trim())&&(u=i.a.createElement(R,{text:c.textContent||"",showText:this.showText,showVariations:this.showVariations,showAnnotations:this.showAnnotations,key:e.index++}))}else console.warn("Child node of unrecognizezd type: ",c);u&&o.push(u)}var h=this.buildProperties(t),p={tag:t.nodeName,key:e.index++,htmlTag:this.getHtmlTag(t.nodeName),showText:this.showText,showVariations:this.showVariations,showAnnotations:this.showAnnotations,teiProps:h},d=i.a.createElement(z,p,o);if(this.chunk&&this.showVariations&&h["app-ref"]){var f=this.chunk.getApp(h["app-ref"]),m="true"===h["first-in-app"];d=i.a.createElement(L,{key:e.index++,showVariations:this.showVariations,showText:this.showText,edition:this.edition,onAppClick:n,app:f,firstInApp:m},[d])}if(this.chunk&&this.showAnnotations&&h.annotatedBy){var v=h.annotatedBy.split(" ").map(function(e){return r.chunk.annotation.getAnnotation(e)});d=i.a.createElement(U,{key:e.index++,showAnnotations:this.showAnnotations,onAnnotationClick:a,annotations:v},[d])}return d}}]),e}();G.index=0;var D=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={elements:void 0},n.getTeiObjects=function(){var e=new G(n.props.showVariations,n.props.showAnnotations,n.props.showText,n.props.edition,n.props.chunk),t=n.props.chunk.mainRoots.map(function(t){return e.teiToReactElement(t,n.props.onAppClick,n.props.onAnnotationClick)});n.setState({elements:t})},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getTeiObjects()}},{key:"componentDidUpdate",value:function(e){e&&this.props.chunk===e.chunk&&this.props.edition===e.edition&&this.props.showText===e.showText&&this.props.showVariations===e.showVariations&&this.props.showAnnotations===e.showAnnotations||this.getTeiObjects()}},{key:"render",value:function(){return i.a.createElement("div",{className:"tei-container",style:{position:"relative"}},this.state.elements)}}]),t}(i.a.Component),F=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={chunkIndex:n.props.chunk,selectedOption:void 0,availableChunks:[],disablePrev:!0,disableNext:!1},n.onChunkChanged=function(e){var t=parseInt(e.value),a=n.state.availableChunks.findIndex(function(e){return e.value===t.toString()});n.setState({chunkIndex:a,selectedOption:e}),n.props.onChunkSelected(t)},n.updateChunk=function(e){n.setState({disablePrev:!1,disableNext:!1});var t=n.state.chunkIndex+1+e;if(1===t?n.setState({disablePrev:!0}):t===n.state.availableChunks.length&&n.setState({disableNext:!0}),-1!==n.props.edition.chunks.indexOf(t)){var a=n.state.availableChunks.find(function(e){return e.value===t.toString()});a||console.error("Can't locate new option!"),n.setState({chunkIndex:t-1,selectedOption:a}),n.props.onChunkSelected(t)}},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.edition!==e.edition){var n=[];if(this.props.edition){n=this.props.edition.chunks.map(function(e){return{value:e.toString(),label:e.toString()}});var a=0;e&&-1===(a=this.state.availableChunks.findIndex(function(t){return t.value===e.chunk.toString()}))&&(a=0);var i=this.props.edition.chunks[a];this.setState({availableChunks:n,chunkIndex:a,selectedOption:n[a]}),this.props.onChunkSelected(i)}}if(this.props.chunk!==e.chunk){var r=this.state.availableChunks.findIndex(function(e){return e.value===t.props.chunk.toString()});-1!==r?this.setState({chunkIndex:r,selectedOption:this.state.availableChunks[r],disablePrev:0===r,disableNext:r===this.state.availableChunks.length-1}):(console.warn("Can't set pager to non existing chunk ".concat(this.props.chunk)),this.setState({chunkIndex:0,selectedOption:this.state.availableChunks[0],disablePrev:!0,disableNext:1===this.state.availableChunks.length}))}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,this.props.edition?i.a.createElement("div",null,i.a.createElement("div",{className:"in-line"},i.a.createElement("label",{className:"bold-choose"},"CHOOSE A SECTION"),i.a.createElement(m.a,{className:"select-style",onChange:this.onChunkChanged,options:this.state.availableChunks,value:this.state.selectedOption})),i.a.createElement("div",{className:"in-line paging-buttons"},i.a.createElement("button",{onClick:function(){return e.updateChunk(-1)},className:"prev",disabled:this.state.disablePrev}),i.a.createElement("label",null,"Previous Section"),i.a.createElement("label",{className:"margin-button"},"Next Section"),i.a.createElement("button",{className:"next",onClick:function(){return e.updateChunk(1)},disabled:this.state.disableNext}))):"")}}]),t}(i.a.Component),J=n(37),H=n.n(J),W=n(38),$=n.n(W),Y=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=T.editions.map(function(e,t){return i.a.createElement("label",{key:t,className:"edition-label"},i.a.createElement(P,{edition:e,key:e.code}),e.name)});return this.props.edition&&"MS"===this.props.edition.code&&(e=i.a.createElement("div",{id:"sga"},i.a.createElement("a",{href:"http://shelleygodwinarchive.org/sc/oxford/frankenstein/volume/iii/#/p30"},i.a.createElement("img",{src:H.a})),i.a.createElement("div",null,"View the manuscript facsimile, transcription and more on the ",i.a.createElement("a",{href:"http://shelleygodwinarchive.org/sc/oxford/frankenstein/volume/iii/#/p30"},"Shelley-Godwin Archive")),i.a.createElement("hr",null))),i.a.createElement("div",null,i.a.createElement("header",{className:"viewer__cols"},i.a.createElement("div",{id:"viewer__legend-editions"},t),i.a.createElement("div",{id:"viewer__title",className:"center-label"},this.props.edition?i.a.createElement("h2",null,this.props.edition.name," Edition"):i.a.createElement("h2",null,"Edition")),i.a.createElement("div",{id:"viewer__legend-variance"},i.a.createElement("label",null,"Amount of Variance"),i.a.createElement("img",{className:"variations",src:$.a,alt:"variations scale"}))),i.a.createElement("hr",{className:"line"}),i.a.createElement("div",{className:"viewer__cols"},i.a.createElement("div",{className:"center-label"},"Marginalia"),i.a.createElement("div",{className:"center-label"},"Text"),i.a.createElement("div",{className:"center-label"},"Variations")),e)}}]),t}(i.a.Component),q=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={showVariations:!0,showAnnotations:!1,showText:!0},n.onVariationChanged=function(){var e=!n.state.showVariations;n.setState({showVariations:e}),n.props.onVariationChanged(e)},n.onAnnotationChanged=function(){var e=!n.state.showAnnotations;n.setState({showAnnotations:e}),n.props.onAnnotationChanged(e)},n.onTextChanged=function(){var e=!n.state.showText;n.setState({showText:e}),n.props.onTextChanged(e)},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.showVariations!==this.state.showVariations&&this.setState({showVariations:this.props.showVariations}),this.props.showText!==this.state.showText&&this.setState({showText:this.props.showText})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("label",{className:"options-label bold-choose"},"CHOOSE OPTIONS"),i.a.createElement("label",{className:"options-label"},i.a.createElement("input",{name:"variation",type:"checkbox",checked:this.state.showVariations,onChange:this.onVariationChanged}),"See Variants"),i.a.createElement("label",{className:"options-label"},i.a.createElement("input",{name:"variation",type:"checkbox",checked:this.state.showAnnotations,onChange:this.onAnnotationChanged}),"See Annotations"),i.a.createElement("label",{className:"options-label"},i.a.createElement("input",{name:"text",type:"checkbox",checked:this.state.showText,onChange:this.onTextChanged}),"See Text"))}}]),t}(i.a.Component),Q=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this.props.group.editions.map(function(e){return e.name}).join(", "),n=this.props.group.editions.map(function(e){return i.a.createElement(P,{small:!0,edition:e,key:e.code})});this.props.group.element?e=new G(!1,!1,!0).teiToReactElement(this.props.group.element):e=i.a.createElement("div",{className:"empty-group"},"[Edition is missing here]");return i.a.createElement("div",{className:"reading-group"},i.a.createElement("div",{className:"reading-group-dots"},n),i.a.createElement("div",{className:"reading-group-title"},t),i.a.createElement("div",{className:"reading-group-content"},e))}}]),t}(i.a.Component),K=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.app.groups.map(function(e){return i.a.createElement(Q,{group:e,key:e.groupId})});return i.a.createElement("div",{className:"app-list"},i.a.createElement("hr",{className:"app-list-to-divider"}),e)}}]),t}(i.a.Component),Z=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var r,o=this.props.annotations[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,c=s.target.selector.filter(function(e){return"TextQuoteSelector"===e.type})[0];e.push(i.a.createElement("div",{key:s.id,style:{lineHeight:"1.5em",display:"block",color:"darkslategray",marginTop:"2em"}},i.a.createElement("blockquote",null,'"...',c.prefix," ",i.a.createElement("span",{style:{color:"#3F3730",fontWeight:"bolder"}},c.exact)," ",c.suffix,'..."'),i.a.createElement("span",{style:{fontStyle:"italic"}},s.body[0].value)))}}catch(u){n=!0,a=u}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return i.a.createElement(i.a.Fragment,null,e)}}]),t}(i.a.Component),ee=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={loading:!1,chunk:void 0,edition:void 0,chunkNumber:0,showVariations:!0,showAnnotations:!1,showText:!0,app:void 0,annotations:void 0},n.onNewChunk=function(){var e=Object(f.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({loading:!0,chunk:void 0}),n.state.edition){e.next=3;break}throw new Error("Cannot get chunk if there is no an edition");case 3:return e.next=5,E.load(n.state.edition,t);case 5:a=e.sent,n.setState({loading:!1,chunk:a,chunkNumber:a.chunkNumber,app:void 0});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onNewEdition=function(e){n.setState({edition:e,app:void 0})},n.onVariation=function(e){n.setState({showVariations:e})},n.onAnnotation=function(e){n.setState({showAnnotations:e})},n.onText=function(e){n.setState({showText:e})},n.onAppClick=function(e){n.setState({app:e,annotations:void 0})},n.onAnnotationClick=function(e){n.setState({annotations:e,app:void 0})},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("section",{id:"viewer"},i.a.createElement("div",{id:"viewer__controls"},i.a.createElement(I,{key:0,editions:T.editions,edition:this.state.edition,onEditionSelected:this.onNewEdition}),i.a.createElement(F,{key:1,edition:this.state.edition,chunk:this.state.chunkNumber,onChunkSelected:this.onNewChunk}),i.a.createElement(q,{showVariations:this.state.showVariations,showAnnotations:this.state.showAnnotations,showText:this.state.showText,onVariationChanged:this.onVariation,onAnnotationChanged:this.onAnnotation,onTextChanged:this.onText})),i.a.createElement(Y,{edition:this.state.edition}),i.a.createElement("div",{id:"viewer__contents",className:"viewer__cols"},i.a.createElement("aside",{id:"viewer__marginalia"}),this.state.chunk&&this.state.edition?i.a.createElement(D,{chunk:this.state.chunk,edition:this.state.edition,showVariations:this.state.showVariations,showAnnotations:this.state.showAnnotations,showText:this.state.showText,onAnnotationClick:this.onAnnotationClick,onAppClick:this.onAppClick}):i.a.createElement("div",null),i.a.createElement("aside",{id:"viewer_variations"},this.state.app?i.a.createElement(K,{app:this.state.app,edition:this.state.edition}):"",this.state.annotations?i.a.createElement(Z,{annotations:this.state.annotations}):"")),i.a.createElement("hr",{className:"line"}),i.a.createElement("footer",{id:"viewer_pagination_controls"},i.a.createElement(I,{key:2,editions:T.editions,edition:this.state.edition,onEditionSelected:this.onNewEdition}),i.a.createElement(F,{key:3,edition:this.state.edition,chunk:this.state.chunkNumber,onChunkSelected:this.onNewChunk})))}}]),t}(i.a.Component),te=(n(86),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"App"},i.a.createElement(ee,null)))}}]),t}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(te,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[40,1,2]]]);
//# sourceMappingURL=main.faba07cd.chunk.js.map